### Have a web traffic port?
  - Is it accessible? What are the response codes and headers?
    - `curl -s -I -L http://<IP>` 
  - Is there a robots.txt?
    - `curl http://<IP>/robots.txt`
  - What service is running behind it? Apache, Nginx, IIS, Tomcat?
    - See above NMAP scan
  - Can you DNS zone transfer? (need domain name)
    - `dig @ns1.example.com example.com axfr`
    - `dig axfr <DOMAIN_NAME_TO_TRANSFER> @<DNS_IP>`
  - Are they any hidden directories? (google.com/XYZ)
    - `ffuf -u http://<IP>/FUZZ -w /usr/share/wordlists/dirb/common.txt`
    - `gobuster dir -u http://<IP> -w wordlist.txt`
    - `dirb http://<IP>/ wordlist.txt`
  - Are there any hidden subdomains? (XYZ.google.com - Remember to add subdomains to your hosts file as you discover them.)
    - `ffuf -u http://FUZZ.example.com -w subdomains.txt -fs 404`
    - `dnsenum --enum inlanefreight.com -f wordlist.txt`
    - `subfinder -d <DOMAIN>`
  - What is the domain name of the ip?
    - `nslookup <IP_ADDRESS>`
  - Can you see any outdated software or known vulnerabilities?
    - See above NMAP scan or `nmap --script vuln <IP>` | `nikto -h http://<IP>`
  - Can you see any subdomains in the CT logs?
    - `curl -s "https://crt.sh/?q=facebook.com&output=json" | jq -r '.[] | select(.name_value | contains("dev")) | .name_value' | sort -u`
  - Is there an SSL/TLS Certificate? Self-signed? And what domains does it cover?
    - `sslscan <IP>:443`
    - `openssl s_client -connect <IP>:443`
   - What kind of authN is there? Can you brute force?
    - `medusa -h <IP> -U userlist.txt -P passlist.txt -M http`
    - `hydra -L users.txt -P passwords.txt <IP> http-post-form "/login:username=^USER^&password=^PASS^:Invalid"`
  - Are there API endpoints? Look for `/api`, `/graphql`, `/swagger`, `/openapi.json`
    - `gobuster dir -u http://<IP> -w api-wordlist.txt`
  - Is there the oppurtunity for SQL Injection, XXS, SSRF or command injection?
  - Can you check cookies and session management? Are they `HttpOnly`, `Secure`, `SameSite`?
  - Can you find a vhost? (Look at the `host` header - does the request hostname match the response hostname?)
    - Add all subdomains/vhosts to hosts file and enumarate again - they can be nested.
    - `ffuf -w /opt/useful/seclists/Discovery/DNS/subdomains-top1million-5000.txt:FUZZ -u http://academy.htb:PORT/ -H 'Host: FUZZ.academy.htb'`
  - Is there a WAF?
    - `wafw00f inlanefreight.com`
    - `nikto -h inlanefreight.com `
  - Have you find anything by web crawling?
    -  `python3 ReconSpider.py http://inlanefreight.com`
  - Is there anything on [WebArchive / Waybackmachine?](https://web.archive.org)

# FFuf Commands (Use domain name)
Useful for fuzzing directories, files + extensions, vhosts, PHP parameters and parameter values. To scan for VHosts, without manually adding the entire wordlist to our /etc/hosts, we will be fuzzing HTTP headers, specifically the Host: header. To do that, we can use the -H flag to specify a header and will use the FUZZ keyword within it. 
- `ffuf -u http://FUZZ.domain:41823 -w /usr/share/wordlists/seclists/Discovery/DNS/subdomains-top1million-5000.txt`
- `ffuf -w /opt/useful/seclists/Discovery/Web-Content/web-extensions.txt:FUZZ -u http://domain:PORT/blog/indexFUZZ`
- `ffuf -w /opt/useful/seclists/Discovery/Web-Content/directory-list-2.3-small.txt:FUZZ -u http://domain:PORT/blog/FUZZ.php` (If we know it runs PHP)
- This one for all enumerating - `ffuf -w cleaned-wordlist.txt:FUZZ -u http://83.136.250.52:37289/FUZZ -recursion -recursion-depth 1 -e .php -mc 200,301,302,403 -t 50 -o results.txt -v`
- This one for VHOST - `ffuf -w /opt/useful/seclists/Discovery/DNS/subdomains-top1million-5000.txt:FUZZ -u http://academy.htb:PORT/ -H 'Host: FUZZ.academy.htb' -fs xxx`
- Parameter Fuzzing GET - `ffuf -w /opt/useful/seclists/Discovery/Web-Content/burp-parameter-names.txt:FUZZ -u http://admin.academy.htb:PORT/admin/admin.php?FUZZ=key -fs xxx`
- Parameter Fuzzing POST (-d) - `ffuf -w /opt/useful/seclists/Discovery/Web-Content/burp-parameter-names.txt:FUZZ -u http://admin.academy.htb:PORT/admin/admin.php -X POST -d 'FUZZ=key' -H 'Content-Type: application/x-www-form-urlencoded' -fs xxx` - then try to use curl with any keys found
- Value Fuzzing - `ffuf -w ids.txt:FUZZ -u http://admin.academy.htb:58083/admin/admin.php -d 'id=FUZZ' -H 'Content-Type: application/x-www-form-urlencoded' -mc 200,302,403,500 -t 50 -v`
- Page fuzzing - `ffuf -w /opt/useful/seclists/Discovery/Web-Content/web-extensions.txt:FUZZ -u http://SERVER_IP:PORT/blog/indexFUZZ`
